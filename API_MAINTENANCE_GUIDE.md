# API文档维护指南 📝

> 确保每个新功能都有对应的API说明文档

## 🎯 维护原则

### 1. **同步更新原则**
- 每添加一个新功能，必须同时更新API文档
- 每修改一个现有API，必须同时更新文档
- 每删除一个API，必须从文档中移除

### 2. **完整性原则**
- 所有公开的类、方法、属性都必须有文档
- 所有参数都必须有类型和描述
- 所有返回值都必须有类型说明

### 3. **准确性原则**
- 文档必须与实际代码保持一致
- 示例代码必须能够正常运行
- 参数类型和默认值必须准确

## 📋 文档更新检查清单

### ✅ 添加新功能时

#### **1. 新增类**
- [ ] 在对应章节添加类说明
- [ ] 添加构造函数文档
- [ ] 添加所有公开属性文档
- [ ] 添加所有公开方法文档
- [ ] 添加使用示例

#### **2. 新增方法**
- [ ] 在对应类下添加方法文档
- [ ] 描述方法功能
- [ ] 列出所有参数及类型
- [ ] 说明返回值类型
- [ ] 添加使用示例

#### **3. 新增属性**
- [ ] 在对应类下添加属性文档
- [ ] 说明属性类型
- [ ] 描述属性用途
- [ ] 标注是否只读

#### **4. 新增枚举**
- [ ] 在枚举章节添加说明
- [ ] 列出所有枚举值
- [ ] 描述每个值的含义

### ✅ 修改现有功能时

#### **1. 修改方法签名**
- [ ] 更新方法参数列表
- [ ] 更新参数类型说明
- [ ] 更新返回值类型
- [ ] 更新使用示例

#### **2. 修改属性**
- [ ] 更新属性类型
- [ ] 更新属性描述
- [ ] 更新默认值说明

#### **3. 修改行为**
- [ ] 更新功能描述
- [ ] 更新使用示例
- [ ] 添加注意事项

### ✅ 删除功能时

#### **1. 删除API**
- [ ] 从文档中移除对应章节
- [ ] 更新相关示例代码
- [ ] 添加迁移指南（如有替代方案）

## 📚 文档结构规范

### 1. **类文档模板**

```markdown
### ClassName

类的简要描述。

#### 构造函数

```dart
ClassName({
  required Type parameter1,
  Type? parameter2,
  Type parameter3 = defaultValue,
})
```

**参数:**
- `parameter1` - 参数描述
- `parameter2` - 参数描述（可选）
- `parameter3` - 参数描述

#### 属性

| 属性 | 类型 | 描述 |
|------|------|------|
| `property1` | `Type` | 属性描述 |
| `property2` | `Type?` | 属性描述（可选） |

#### 方法

##### methodName
```dart
ReturnType methodName(Type parameter)
```
方法描述。

**参数:**
- `parameter` - 参数描述

**返回:** `ReturnType` - 返回值描述

**示例:**
```dart
final result = instance.methodName(value);
```
```

### 2. **方法文档模板**

```markdown
##### methodName
```dart
ReturnType methodName({
  required Type parameter1,
  Type? parameter2,
})
```
方法功能描述。

**参数:**
- `parameter1` - 参数描述
- `parameter2` - 参数描述（可选）

**返回:** `ReturnType` - 返回值描述

**异常:**
- `ExceptionType` - 异常条件描述

**示例:**
```dart
try {
  final result = await instance.methodName(
    parameter1: value1,
    parameter2: value2,
  );
  print('Success: $result');
} catch (e) {
  print('Error: $e');
}
```
```

### 3. **枚举文档模板**

```markdown
### EnumName

枚举描述。

```dart
enum EnumName {
  value1,    // 值描述
  value2,    // 值描述
  value3,    // 值描述
}
```

**值说明:**
- `value1` - 值的详细描述
- `value2` - 值的详细描述
- `value3` - 值的详细描述
```

## 🔄 文档更新流程

### 1. **开发阶段**
```mermaid
graph LR
    A[编写代码] --> B[添加注释]
    B --> C[更新API文档]
    C --> D[编写示例]
    D --> E[测试示例]
```

### 2. **审查阶段**
- 代码审查时同时审查文档
- 确保文档与代码一致
- 验证示例代码可运行

### 3. **发布阶段**
- 生成最新API文档
- 更新版本号
- 发布到文档网站

## 🛠️ 文档工具

### 1. **自动生成工具**

使用dartdoc生成API文档：

```bash
# 生成API文档
dart doc

# 预览文档
dart doc --serve
```

### 2. **文档验证脚本**

创建脚本验证文档完整性：

```dart
// tools/doc_validator.dart
void main() {
  // 检查所有公开API是否有文档
  // 验证示例代码语法
  // 检查链接有效性
}
```

### 3. **CI/CD集成**

在CI流程中添加文档检查：

```yaml
# .github/workflows/docs.yml
name: Documentation
on: [push, pull_request]
jobs:
  docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: dart-lang/setup-dart@v1
      - run: dart pub get
      - run: dart doc --dry-run
      - run: dart run tools/doc_validator.dart
```

## 📖 文档编写最佳实践

### 1. **清晰简洁**
- 使用简单明了的语言
- 避免技术术语过多
- 提供具体的使用场景

### 2. **示例丰富**
- 每个重要API都提供示例
- 示例代码要完整可运行
- 覆盖常见使用场景

### 3. **结构清晰**
- 使用统一的文档格式
- 保持章节结构一致
- 提供清晰的导航

### 4. **及时更新**
- 代码变更时立即更新文档
- 定期检查文档准确性
- 收集用户反馈改进文档

## 📋 文档质量检查

### 每周检查项目
- [ ] 所有新增API都有文档
- [ ] 所有示例代码可正常运行
- [ ] 文档链接都有效
- [ ] 版本信息是最新的

### 每月检查项目
- [ ] 文档结构是否需要调整
- [ ] 是否需要添加新的章节
- [ ] 用户反馈是否需要处理
- [ ] 文档是否需要重新组织

### 发版前检查
- [ ] 所有API变更都已文档化
- [ ] 迁移指南已更新
- [ ] 版本号已更新
- [ ] 变更日志已更新

## 🎯 文档维护责任

### 开发者责任
- 编写代码时同时编写文档
- 确保文档与代码同步
- 提供清晰的使用示例

### 审查者责任
- 审查代码时检查文档
- 验证文档准确性
- 确保文档质量

### 维护者责任
- 定期检查文档完整性
- 处理用户文档反馈
- 持续改进文档质量

---

**遵循这个指南，确保API文档始终保持高质量和准确性！** 📚✨
